.. overview_directive
.. |prancSTR overview| replace:: prancSTR takes in a VCF file generated by HipSTR from one or more samdples an identifies STRs with evidence of somatic mosaicism.
.. overview_directive_done

prancSTR
=========

Population-level heterogeneity generally arises due to germline mutations that occur before the formation of the zygote and are inherited by all cells in the offspring.
However, heterogeneity within an individual may also exist due to somatic mutations that occur post-zygotically in only a sub-population of cells (). 

Short tandem repeats (STRs) consist of repeated sequences of 1-6bp and comprise more than 1 million loci in the human genome. Somatic mosaicism at STRs is known 
to play a key role in the pathogenicity of loci implicated in repeat expansion disorders, and is highly prevalent in cancers exhibiting microsatellite instability.
While a variety of tools have been developed to genotype germline variation at STRs, no method currently exists for systematically identifying mosaic STRs (mSTRs).

We introduce prancSTR, a novel method for detecting mSTRs from individual next-generation sequencing datasets. Unlike many existing mosaicism detection methods 
for other variant types, prancSTR does not require a matched control sample as input.


Usage
-----
To run prancSTR use the following command::

	prancSTR \
  	  --vcf <vcf file> \
  	  --out <string> \
  	  [filter options]

Required parameters:

* :code:`--vcf <VCF>` Input VCF file, generated by HipSTR. 
* :code:`--out <string>` Output file prefix. Use :code:`stdout` to print file to standard output

prancSTR will output a tab-delimited file with candidate mosaic STRs (mSTRs) either to stdout or to :code:`$out.tab`. See a description of the output file below.

Other general parameters:

* :code:`--region <string>`: Restrict to the region chr:start-end. VCF file must be bgzipped and indexed to use this option.
* :code:`--samples <string>`: Restrict to the given list of samples. Samples are comma separated
* :code:`--vcftype <string>`: Specify the tool which generated the vcf call file for STRs. e.g. hipstr, gangstr etc.
* :code:`--only-passing <action=store_true>`: Filter out segmental duplication regions.
* :code:`--output-all <action=store_true>`: Force tool to output results for all loci.
* :code:`--debug <action=store_true>`: Print helpful debug messages.
* :code:`--quiet <action=store_true>`: Restrict printing of any messages.
* :code:`--version`: Print the version of the tool

See `Example Commands`_ for examples running prancSTR under different settings.

Output files
------------
The final output is a tab-delimited file with candidate mosaic STRs (mSTRs) corresponding to different loci comprising of 16 columns: 

1. sample: The ID of the sample whose locus is being analyzed.
2. chrom: The chromosome on which the mosaic short tandem repeat (STR) lies.
3. locus: Reference ID for the short tandem repeat.
4. motif: The nucleotide sequence that the repeat is comprised of.
5. A: Represents the first genotype allele for the given STR.
6. B: Represents the second genotype allele for the given STR.
7. C: This is the mosaic allele inferred by prancSTR.
8. f: This represents the mosaic allele fraction. 
9. pval: Gives the p-value metric for how significant our findings are.
10. reads: Gives representation for how many reads support each allele.
11. mosaic_support: The number of reads that support the mosaic allele. 
12. stutter parameter u: Gives the probability that stutter error causes an increase in obs. STR size.
13. stutter parameter d: Gives the probability that stutter error causes a decrease in obs. STR size.
14. stutter parameter rho: Parameter for geometric step size distribution.
15. quality factor: Reports the posterior probability of the genotype as a mesaure of quality of individual sample's genotype.
16. read depth: Reports the total depth/number of informative reads for all samples at the locus.

stutter parameter u, stutter parameter d, stutter parameter rho, quality factor and read depth are the parameters that have been imported from what HipSTR outputs.
Below is an example file which contains 5 STR loci 

**NOTE: This is an example file based on our analysis. Values will change based on dataset.**

+---------+-------+---------+---------------+-------+----+---+---+----------+--------------+------------------+----------------+---------------------+--------------------+----------------------+----------------+------------+
| sample  | chrom |   pos   |     locus     | motif | A  | B | C |    f     |     pval     |      reads       | mosaic_support | stutter parameter u | stutter paramter d | stutter paramter rho | quality factor | read depth |
+=========+=======+=========+===============+=======+====+===+===+==========+==============+==================+================+=====================+====================+======================+================+============+
| NA07022 | chr1  | 987287  | Human_STR_285 |   T   | 3  | 5 | 2 | 0.244079 | 1.530865e-04 | 2|4;3|4;5|4;6|1  |       4        |        0.01         |        0.07        |         0.31         |      0.98      |     21     |
+---------+-------+---------+---------------+-------+----+---+---+----------+--------------+------------------+----------------+---------------------+--------------------+----------------------+----------------+------------+
| NA12716 | chr1  | 987287  | Human_STR_285 |   T   | 5  | 5 | 4 | 0.265958 | 1.842418e-05 |   4|6;5|15;9|1   |       6        |        0.01         |        0.07        |         0.31         |      1.00      |     34     |
+---------+-------+---------+---------------+-------+----+---+---+----------+--------------+------------------+----------------+---------------------+--------------------+----------------------+----------------+------------+
| NA06989 | chr1  | 1002414 | Human_STR_295 |   T   | -1 | 4 | 3 | 0.150960 | 6.045544e-05 |  -1|16;3|4;4|9   |       4        |        0.02         |        0.02        |         0.69         |      1.00      |     50     |
+---------+-------+---------+---------------+-------+----+---+---+----------+--------------+------------------+----------------+---------------------+--------------------+----------------------+----------------+------------+
| NA10847 | chr1  | 1002414 | Human_STR_295 |   T   | 4  | 5 | 3 | 0.280689 | 1.290112e-09 | 2|1;3|7;4|6;5|11 |       7        |        0.02         |        0.02        |         0.69         |      1.00      |     55     |
+---------+-------+---------+---------------+-------+----+---+---+----------+--------------+------------------+----------------+---------------------+--------------------+----------------------+----------------+------------+
| NA12347 | chr1  | 1002414 | Human_STR_295 |   T   | 5  | 5 | 4 | 0.262358 | 1.029537e-05 | 3|1;4|5;5|14;6|1 |       5        |        0.02         |        0.02        |         0.69         |      0.99      |     51     |
+---------+-------+---------+---------------+-------+----+---+---+----------+--------------+------------------+----------------+---------------------+--------------------+----------------------+----------------+------------+

Example Commands
----------------

Below are :code:`prancSTR` examples using HipSTR VCFs. Data files can be found at https://github.com/gymreklab/TRTools/tree/master/example-files::

	prancSTR
        --vcf /expanse/projects/gymreklab/mousavi/results/1000genomes/hipstr_outs/EUR/CEU/merged/CEU_filtered.vcf.gz
        --out /expanse/projects/gymreklab/aasehgal/data_DeSASTR/resources/chrom_pop_files/CEU_chr1
        --vcftype hipstr
        --only-passing
        --region chr1

	prancSTR
    	--vcf CEU_filtered.vcf.gx
    	--only-passing
    	--out NA12878_mosaicSTR
    	--samples NA12878